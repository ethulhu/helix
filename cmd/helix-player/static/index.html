<!DOCTYPE html>
<html lang='en'>
<head>
	<meta charset='utf-8'>
	<title>Helix Player</title>
	<style>
:root {
	--background-color:  hsl(0, 0%, 100%);
	--callout-color:     hsl(0, 0%, 90%);

	--foreground-color:  hsl(0, 0%, 0%);
	--link-color:        hsl(0, 0%, 50%);
	--link-hover-color:  hsl(205, 69%, 50%);
}
@media (prefers-color-scheme: dark) {
	:root {
		--background-color:  hsl(0, 0%, 12%);
		--callout-color:     hsl(0, 0%, 24%);

		--foreground-color:  hsl(0, 0%, 82%);
		--link-color:        hsl(0, 0%, 65%);
		--link-hover-color:  hsl(259, 49%, 65%);
	}
}

body {
	background-color:  var(--background-color);
	color:             var(--foreground-color);

	font-size:    14pt;
	font-family:  sans-serif;

	min-width:    12em;
	padding:      0.5em;
}
@media screen and ( min-width: 40em ) {
	body {
		margin:     0 auto;
		max-width:  30em;
	}
}
button, select, details {
	background-color:  var(--callout-color);
	color:             var(--foreground-color);

	font-size:    12pt;
	font-family:  sans-serif;

	border-radius:  5px;
	border:         solid 3px var(--callout-color);
	filter:         drop-shadow(1px 1px 1px black);
	margin-top:     3px;
	margin-bottom:  3px;
}
button:active {
	filter:     drop-shadow(1px 1px 0.5px black);
	transform:  translateY(1px);
}

main {
	height: 100vh;

	display: grid;
	grid-template-areas: "player" "directory";
	grid-template-rows: auto 1fr;
}
#player {
	grid-area: player;
}
#player audio {
	width: 100%;
}
#player video {
	width: 100%;
}

#directory {
	grid-area: directory;
	overflow-y: scroll;
}
#directory button:disabled {
	text-decoration: line-through;
}

input[type=checkbox] ~ ul {
        visibility: hidden;
}
input[type=checkbox]:checked ~ ul {
        visibility: visible;
}
	</style>
</head>

<body>
	<main>
		<div id='player'>
		</div>

		<div id='directory'>
		</div>
	</main>

	<script type='module'>
		import { Directory } from './directory.js';
		import { Player    } from './player.js';

		class API {
			constructor() {
				this.rootObject = '0';
			}
			async directories() {
				const rsp = await fetch( '/directories/', {
					headers: {
						Accept: 'application/json',
					}
				} );
				return rsp.json()
			}

			async object( directory, id ) {
				const rsp = await fetch( `/directories/${directory}/${id}`, {
					headers: {
						Accept: 'application/json',
					}
				} );
				return rsp.json()
			}

			async objectBlob( directory, id, mimetype ) {
				const rsp = await fetch(
					`/directories/${directory}/${id}?accept=${mimetype}`
				);
				return rsp.blob();
			}
		}

		const api = new API();
		const player = new Player( document.querySelector( '#player' ) );
		const directory = new Directory( document.querySelector( '#directory' ), api, player );

		directory.loadDirectories();
	</script>
</body>
</html>
