<!DOCTYPE html>
<html lang='en'>
<head>
	<meta charset='utf-8'>
	<title>Helix Player</title>
	<style>
input[type=checkbox] ~ ul {
        visibility: hidden;
}
input[type=checkbox]:checked ~ ul {
        visibility: visible;
}
	</style>
</head>

<body>
	<main>
		<div id='player'>
		</div>

		<div id='directory'>
		</div>
	</main>

	<script type='module'>
		import { Directory } from './directory.js';
		import { Player    } from './player.js';

		class API {
			constructor() {
				this.rootObject = '0';
			}
			async directories() {
				const rsp = await fetch( '/directories/', {
					headers: {
						Accept: 'application/json',
					}
				} );
				return rsp.json()
			}

			async object( directory, id ) {
				const rsp = await fetch( `/directories/${directory}/${id}`, {
					headers: {
						Accept: 'application/json',
					}
				} );
				return rsp.json()
			}

			async objectBlob( directory, id, mimetype ) {
				const rsp = await fetch(
					`/directories/${directory}/${id}?accept=${mimetype}`
				);
				return rsp.blob();
			}
		}

		const api = new API();
		const player = new Player( document.querySelector( '#player' ) );
		const directory = new Directory( document.querySelector( '#directory' ), api, player );

		directory.loadDirectories();
	</script>
</body>
</html>
